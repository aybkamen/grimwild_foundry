.item-form {
	font-family: $font-body;
}

.standard-form {
	input[type="text"],
	input[type="number"] {
		height: auto;
		line-height: 1.8;

		body.theme-light & {
			background: #ffffff33;
			border-color: #00000022;
		}
	}

	input::placeholder {
		font-style: italic;
		opacity: 0.5;
	}

	fieldset {
		legend {
			font-variant: small-caps;
			font-size: 18px;
		}
	}
}

.sheet-header {
	// flex: 0 auto;
	// overflow: hidden;
	display: flex;
	flex-direction: row;
	flex-wrap: wrap;
	justify-content: flex-start;
	margin-bottom: 10px;

	.profile-img {
		flex: 0 0 100px;
		height: 100px;
		margin-right: 10px;
	}

	.header-fields {
		flex: 1;
	}
}

.sheet-tabs {
	// flex: 0;
}

.sheet-body,
.sheet-body .tab,
.sheet-body .tab .editor {
	height: 100%;
}

.tab.biography {
	flex: 1;

	.editor {
		height: 100%;
	}
}

.tox {
	.tox-editor-container {
		background: $c-white;
	}

	.tox-edit-area {
		padding: 0 8px;
	}
}

.form-group.stacked {
	> label {
		line-height: 1;
		padding-top: $padding-md;
	}
}

.xp {
	margin-top: 8px;

	> .grid {
		margin: 0;
	}

	input[type="checkbox"] {
		width: 20px;
		height: 20px;

		&::before,
		&::after {
			font-size: 18px;
			line-height: 18px;
			margin: 0;
		}
	}

	input[type="checkbox"]:last-child {
		&::before {
			color: #483d49;
		}

		&:checked::before {
			color: var(--checkbox-checkmark-color);
		}

		&:checked::after {
			color: #e45117;
		}
	}
}

.wises > .form-group.stacked,
.traits > .form-group.stacked,
.desires > .form-group.stacked,
.bonds > .form-group.stacked,
.conditions > .form-group.stacked {
	gap: 2px;
}

// Compact list spacing for special assets and flaws
.special-assets.form-group.stacked,
.flaws.form-group.stacked {
    gap: 2px;
}

// Add another fieldset.
.add-another-entries {
	position: relative;
	margin-top: 4px;

	fieldset {
		position: relative;
	}

	.legend-control {
		position: absolute;
		top: -20px;
		right: 16px;
		width: 20px;
		height: 20px;
		text-align: center;
		line-height: 20px;
		display: flex;
		align-items: center;
		justify-content: center;

		i {
			margin: 0;
		}
	}
}

.entry {
	position: relative;

	&:hover {
		.entry-delete {
			display: block;
		}
	}

	.entry-delete {
		display: none;
		position: absolute;
		top: 0;
		bottom: 0;
		right: -8px;
		margin: auto;
		background: black;
		width: 20px;
		height: 20px;
		text-align: center;
		line-height: 20px;
		border: 1px solid;
		border-radius: 4px;

		&:hover,
		&:focus {
			color: #ba0505;
			text-shadow: none;
		}
	}
}

// Bonds.
.bonds-fieldset {
	position: relative;

	.bond-create {
		position: absolute;
		top: -20px;
		right: 16px;
		width: 20px;
		height: 20px;
		text-align: center;
		line-height: 20px;
		display: flex;
		align-items: center;
		justify-content: center;

		i {
			margin: 0;
		}
	}
}

.bond {
	position: relative;

	&:hover {
		.bond-delete {
			display: block;
		}
	}

	.bond-delete {
		display: none;
		position: absolute;
		top: 0;
		bottom: 0;
		right: -16px;
		margin: auto;
		background: black;
		width: 20px;
		height: 20px;
		text-align: center;
		line-height: 20px;
		border: 1px solid;
		border-radius: 4px;

		&:hover,
		&:focus {
			color: #ba0505;
			text-shadow: none;
		}
	}
}

// Conditions.
.conditions-fieldset {
    position: relative;

	.condition-create {
		position: absolute;
		top: -20px;
		right: 16px;
		width: 20px;
		height: 20px;
		text-align: center;
		line-height: 20px;
		display: flex;
		align-items: center;
		justify-content: center;

		i {
			margin: 0;
		}
	}
}

// Flaws: keep compact height matching its content
.flaws-fieldset {
    align-self: start;
}

// Special Assets: keep compact height matching its content
.special-assets-fieldset {
    align-self: start;
}

.condition {
	position: relative;

	&:hover {
		.condition-delete {
			display: block;
		}
	}

	.condition-delete {
		display: none;
		position: absolute;
		top: 0;
		bottom: 0;
		right: -16px;
		margin: auto;
		background: black;
		width: 20px;
		height: 20px;
		text-align: center;
		line-height: 20px;
		border: 1px solid;
		border-radius: 4px;

		&:hover,
		&:focus {
			color: #ba0505;
			text-shadow: none;
		}
	}
}

.condition-duration {
	display: flex;
	flex-direction: row;
	flex-wrap: nowrap;
	gap: 8px;
}

.condition-roll,
.conditoin-value-pool {
	flex: 0;
}

.condition-value-pool {
	white-space: nowrap;
	flex-wrap: nowrap;
	gap: 4px;

	input {
		width: 0;
		padding: 0;
		height: auto;
		line-height: 1;
		flex: 0;
		border: 1px solid;
		text-align: center;
	}
}

.condition-roll {
	padding: 4px 10px;
	height: auto;
	display: flex;
	align-items: center;
	justify-content: center;
	line-height: 1;

	i {
		padding: 0 4px 0 0;
		margin: 0;
	}

	strong {
		padding: 0;
	}
}

.condition-value-pool {
	display: flex;
	align-items: center;
	flex-direction: row;
}

// Right column wrapper to stack fieldsets tightly
.details-right-col {
    display: flex;
    flex-direction: column;
    gap: 10px;
}

// XP
.xp {
	gap: 0;

	input[type="checkbox"] {
		margin: 0;
	}
}

// Pools
.roll-pool {
	> * {
		flex: 0;
	}

	> input {
		flex: 0 0 40px;
	}

	button {
		text-align: center;

		i {
			margin: 0;
		}
	}

	.roll-pool-suffix {
		white-space: nowrap;
	}
}

.standard-form {
    .roll-pool {
        flex-wrap: nowrap;
    }
}

// Backpack styling (Items tab)
.backpack-fieldset {
    .form-group.stacked { gap: 4px; }
    input.backpack-slot {
        font-size: 12px; // slightly smaller to fit more text
        font-weight: 400; // lighter weight for density
    }
}

// Treasure layout
.treasure-fieldset {
    .treasure-rows {
        display: grid;
        grid-template-columns: max-content 1fr; // two columns: labels and checks
        column-gap: 12px;
        row-gap: 10px;
        align-items: center;
    }
    // legacy row style no longer used but kept harmlessly
    .treasure-row { display: contents; }
    .treasure-label {
        flex: 0 0 auto; // don't push checks to the right
        font-family: $font-display;
        font-size: 16px;
        color: $c-dark; // stronger contrast on dark background
        letter-spacing: 0.2px;
        white-space: nowrap;
        z-index: 1;
        display: inline-block;
    }
    .treasure-checks {
        display: flex;
        gap: 6px;
        flex: 0 0 auto; // stay next to label
    }
    .treasure-checks input[type="checkbox"] {
        width: 20px;
        height: 20px;
        margin: 0;
    }
}

// Generic hover tooltip for inputs
.tooltip-wrapper { position: relative; }
.tooltip-wrapper .tooltip {
    position: absolute;
    left: 0;
    top: calc(100% + 4px); // place below input to avoid clipping by tab's overflow
    transform: none;
    background: rgba(0,0,0,0.9);
    color: #fff;
    border: 1px solid #6b5b53;
    border-radius: 6px;
    padding: 6px 8px;
    max-width: 320px;
    white-space: normal; // allow wrapping
    line-height: 1.2;
    z-index: 10000; // ensure above tabs and strokes
    pointer-events: none;
    // delayed fade-in, quick fade-out
    opacity: 0;
    visibility: hidden;
    transition: opacity 120ms ease-in-out;
}
body.theme-light .tooltip-wrapper .tooltip {
    background: #fff;
    color: #222;
}
.tooltip-wrapper:hover .tooltip {
    opacity: 1;
    visibility: visible;
    transition-delay: 180ms; // slight hover delay before showing
}
.tooltip-wrapper .tooltip:empty { display: none !important; }
